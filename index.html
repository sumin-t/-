<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ğŸª ë‚˜ë§Œì˜ í–‰ì„± ê·¸ë¦¼ ë§Œë“¤ê¸° (HTML)</title>
  <style>
    :root {
      --bg: #0b1020; --card: #121a33; --text: #eef3ff; --muted: #9fb0ff;
      --accent: #6ea8ff; --accent-2: #9ee5ff; --warn: #ffcc66; --err: #ff6b6b;
    }
    * { box-sizing: border-box; }
    body { margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; background: radial-gradient(1200px 800px at 80% -20%, #1b2a6b22, transparent), var(--bg); color: var(--text); }
    header { text-align: center; padding: 28px 16px 8px; }
    header h1 { margin: 0; font-size: 1.8rem; letter-spacing: 0.2px; }
    header p { margin: 6px 0 0; color: var(--muted); }

    .container { max-width: 980px; margin: 0 auto; padding: 20px 16px 48px; }

    .card { background: linear-gradient(180deg, #121a33, #0f1530); border: 1px solid #2a335e; border-radius: 18px; padding: 20px; box-shadow: 0 8px 30px #00000044; }
    .grid { display: grid; grid-template-columns: 1.1fr 1fr; gap: 18px; }
    @media (max-width: 900px) { .grid { grid-template-columns: 1fr; } }

    label { display: block; margin: 12px 0 6px; font-weight: 600; color: var(--muted); }
    select, textarea, input[type="text"] {
      width: 100%; padding: 12px 14px; border-radius: 12px; border: 1px solid #334072; background: #0c1330; color: var(--text);
      outline: none; transition: border .15s ease;
    }
    select:focus, textarea:focus { border-color: var(--accent); }
    textarea { min-height: 110px; resize: vertical; }

    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    @media (max-width: 600px) { .row { grid-template-columns: 1fr; } }

    .btn {
      appearance: none; border: 0; background: linear-gradient(180deg, var(--accent), #4c87ff);
      color: #051026; font-weight: 800; letter-spacing: .3px; padding: 12px 16px; border-radius: 14px; cursor: pointer; box-shadow: 0 6px 20px #2b54ff55;
      transition: transform .06s ease, filter .2s ease; width: 100%;
    }
    .btn:disabled { filter: grayscale(0.7) brightness(.7); cursor: not-allowed; }
    .btn:hover:not(:disabled) { transform: translateY(-1px); }

    .preview { background: #0a1028; border: 1px dashed #30407a; border-radius: 16px; min-height: 280px; display: grid; place-items: center; overflow: hidden; }
    .preview img { width: 100%; height: auto; display: block; }

    .hint { font-size: .92rem; color: var(--muted); }
    .small { font-size: .86rem; color: #b6c4ff; }
    .hidden { display: none; }
    .status { margin-top: 10px; padding: 10px 12px; border-radius: 12px; }
    .status.info { background: #0f1842; border: 1px solid #2c3a7a; }
    .status.warn { background: #3d2a05; border: 1px solid #a77a01; color: #ffe9b2; }
    .status.err  { background: #3d0d10; border: 1px solid #c23d45; color: #ffd6da; }

    .tips { margin-top: 18px; padding: 14px 16px; border: 1px solid #2a335e; border-radius: 14px; background: #0e1633; }
    .tips ul { margin: 6px 0 0 20px; }

    .download { margin-top: 10px; display: flex; gap: 10px; align-items: center; }
    .download a { text-decoration: none; color: var(--accent-2); font-weight: 700; }
  </style>
  <!--
    âš ï¸ ì¤‘ìš”: ì´ HTMLì€ API í‚¤ë¥¼ ì§ì ‘ ë‹´ì§€ ì•ŠìŠµë‹ˆë‹¤. ë°˜ë“œì‹œ ì„œë²„(ë°±ì—”ë“œ)ì—ì„œ OpenAI APIë¥¼ í˜¸ì¶œí•˜ì„¸ìš”.
    ì•„ë˜ JSëŠ” /api/generate ë¡œ POST ìš”ì²­ì„ ë³´ëƒ…ë‹ˆë‹¤. (ì˜ˆì‹œ FastAPI/Expressë¥¼ ì„œë²„ì— êµ¬í˜„)

    ê¸°ëŒ€í•˜ëŠ” ì‘ë‹µ í˜•ì‹ (ë‘˜ ì¤‘ í•˜ë‚˜)
    1) { "image_b64": "<base64_png>" }
    2) { "image_url": "https://..." }
  -->
</head>
<body>
  <header>
    <h1>ğŸª ë‚˜ë§Œì˜ í–‰ì„± ê·¸ë¦¼ ë§Œë“¤ê¸°</h1>
    <p class="small">í–‰ì„±ì„ ê³ ë¥´ê³  í”„ë¡¬í”„íŠ¸ë¥¼ ì ìœ¼ë©´ AIê°€ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•´ìš”. (í•™êµ ë‚´ë¶€ ì „ìš©)</p>
  </header>

  <div class="container">
    <div class="card grid">
      <section>
        <label for="planet">í–‰ì„± ì„ íƒ</label>
        <select id="planet">
          <option value="Mercury" data-style="ì‘ê³  íšŒìƒ‰ë¹›, ë§ì€ ìš´ì„ í¬ë ˆì´í„°, ëŒ€ê¸° í¬ë°•, íƒœì–‘ì— ë§¤ìš° ê°€ê¹Œì›€">ìˆ˜ì„± (Mercury)</option>
          <option value="Venus" data-style="ë‘êº¼ìš´ í™©ë°±ìƒ‰ êµ¬ë¦„, ë§¤ìš° ëœ¨ê±°ì›€, ë¶€ë“œëŸ¬ìš´ ê´‘ì±„, ì•½í•œ í‘œë©´ ë””í…Œì¼">ê¸ˆì„± (Venus)</option>
          <option value="Earth" data-style="í‘¸ë¥¸ ë°”ë‹¤, í•˜ì–€ êµ¬ë¦„, ì´ˆë¡ê³¼ ê°ˆìƒ‰ ëŒ€ë¥™, ìƒëª… ë„˜ì¹˜ëŠ” ëŠë‚Œ">ì§€êµ¬ (Earth)</option>
          <option value="Mars" data-style="ì ê°ˆìƒ‰ ì‚¬ë§‰, ê±°ëŒ€í•œ í™”ì‚°ê³¼ í˜‘ê³¡, ì—·ì€ ëŒ€ê¸°, ë¨¼ì§€í­í’ ê°€ëŠ¥">í™”ì„± (Mars)</option>
          <option value="Jupiter" data-style="ê°ˆìƒ‰ê³¼ í¬ë¦¼ìƒ‰ ì¤„ë¬´ëŠ¬, ê±°ëŒ€í•œ ë¶‰ì€ ì  í­í’, ê±°ëŒ€ ê°€ìŠ¤í–‰ì„±">ëª©ì„± (Jupiter)</option>
          <option value="Saturn" data-style="ì•„ë¦„ë‹¤ìš´ ê³ ë¦¬, í™©ê¸ˆë¹› ê°€ìŠ¤ì¸µ, ì„¬ì„¸í•œ ê³ ë¦¬ êµ¬ì¡° ë””í…Œì¼">í† ì„± (Saturn)</option>
          <option value="Uranus" data-style="ë°ì€ ì²­ë¡ìƒ‰, ì˜…ì€ êµ¬ë¦„, ì˜†ìœ¼ë¡œ ëˆ„ìš´ ìì „ì¶•, ì°¨ë¶„í•œ ëŠë‚Œ">ì²œì™•ì„± (Uranus)</option>
          <option value="Neptune" data-style="ì§„í•œ íŒŒë€ìƒ‰, ê°•í•œ ë°”ëŒ, ì–´ë‘ìš´ ì  í­í’ ê°€ëŠ¥, ì°¨ê°‘ê³  ê¹Šì€ ë°”ë‹¤ ëŠë‚Œ">í•´ì™•ì„± (Neptune)</option>
        </select>

        <label for="prompt">í”„ë¡¬í”„íŠ¸</label>
        <textarea id="prompt" placeholder="ì˜ˆ) ì•„ì´ë“¤ì´ ë°”ë¼ë³´ëŠ” ë§Œí™”í’, ë³„ë¹›ì´ ë°˜ì§ì´ëŠ” ë°°ê²½, ë”°ëœ»í•œ ìƒ‰ê°"></textarea>

        <div class="row">
          <div>
            <label for="style">ìŠ¤íƒ€ì¼ (ì„ íƒ)</label>
            <select id="style">
              <option value="">ìë™</option>
              <option>ìˆ˜ì±„í™”</option>
              <option>ë§Œí™”í’</option>
              <option>í”½ì…€ì•„íŠ¸</option>
              <option>ìœ í™”</option>
              <option>ë¦¬ì–¼ë¦¬ì¦˜</option>
              <option>í”Œë« ì¼ëŸ¬ìŠ¤íŠ¸</option>
            </select>
          </div>
          <div>
            <label for="size">ì´ë¯¸ì§€ í¬ê¸°</label>
            <select id="size">
              <option>1024x1024</option>
              <option>1024x1792</option>
              <option>1792x1024</option>
            </select>
          </div>
        </div>

        <div style="margin-top:16px; display:flex; gap:10px; align-items:center;">
          <button id="generate" class="btn">ê·¸ë¦¼ ë§Œë“¤ê¸°</button>
          <span id="spinner" class="small hidden">ìƒì„± ì¤‘ì…ë‹ˆë‹¤â€¦ ì ì‹œë§Œìš”.</span>
        </div>

        <div id="status" class="status info hidden"></div>
        <div class="tips">
          <div class="hint">ğŸ’¡ í”„ë¡¬í”„íŠ¸ íŒ</div>
          <ul>
            <li>ì¥ë©´ ìš”ì†Œë¥¼ êµ¬ì²´ì ìœ¼ë¡œ: ë³„, ì„±ìš´, ìš°ì£¼ì„ , ìœ„ì„± ë“±</li>
            <li>ìƒ‰ê°Â·ë¶„ìœ„ê¸°: ë”°ëœ»í•œ/ì°¨ê°€ìš´, ì‹ ë¹„ë¡œìš´, ë™í™” ê°™ì€</li>
            <li>ìŠ¤íƒ€ì¼: ìˆ˜ì±„í™”, ë§Œí™”í’, ë¦¬ì–¼ ë“±</li>
            <li>êµ¬ë„: â€œí–‰ì„±ì€ í¬ê²Œ, ì•„ì´ë“¤ì€ ì‘ê²Œâ€ ê°™ì´ ëª…ì‹œ</li>
          </ul>
        </div>
      </section>

      <section>
        <div class="preview" id="preview">
          <div class="hint">ì—¬ê¸°ì— ì´ë¯¸ì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤</div>
        </div>
        <div class="download hidden" id="downloadWrap">
          <a id="downloadLink" download>ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ</a>
          <span id="meta" class="small"></span>
        </div>
      </section>
    </div>
  </div>

  <script>
    const el = (id) => document.getElementById(id);
    const planetSel = el('planet');
    const promptEl  = el('prompt');
    const styleSel  = el('style');
    const sizeSel   = el('size');
    const genBtn    = el('generate');
    const spinner   = el('spinner');
    const statusBox = el('status');
    const preview   = el('preview');
    const dlWrap    = el('downloadWrap');
    const dlLink    = el('downloadLink');
    const meta      = el('meta');

    function showStatus(msg, kind='info') {
      statusBox.textContent = msg;
      statusBox.className = `status ${kind}`;
      statusBox.classList.remove('hidden');
    }
    function hideStatus() { statusBox.classList.add('hidden'); }

    function showSpinner(on) {
      spinner.classList.toggle('hidden', !on);
      genBtn.disabled = on;
    }

    function setPreviewFromB64(b64) {
      const src = `data:image/png;base64,${b64}`;
      const img = new Image(); img.src = src; img.alt = 'ìƒì„±ëœ ì´ë¯¸ì§€';
      preview.innerHTML = ''; preview.appendChild(img);
      // ë‹¤ìš´ë¡œë“œ ë§í¬ êµ¬ì„±
      const blob = b64ToBlob(b64, 'image/png');
      const url = URL.createObjectURL(blob);
      dlLink.href = url; dlLink.download = makeFileName('png');
      dlWrap.classList.remove('hidden');
      meta.textContent = new Date().toLocaleString();
    }

    function setPreviewFromURL(url) {
      const img = new Image(); img.src = url; img.alt = 'ìƒì„±ëœ ì´ë¯¸ì§€'; img.referrerPolicy = 'no-referrer';
      preview.innerHTML = ''; preview.appendChild(img);
      dlLink.href = url; dlLink.download = makeFileName('jpg');
      dlWrap.classList.remove('hidden');
      meta.textContent = new Date().toLocaleString();
    }

    function makeFileName(ext) {
      const p = planetSel.value || 'planet';
      const ts = new Date().toISOString().replaceAll(':', '').replaceAll('-', '').slice(0,15);
      return `${p}_${ts}.${ext}`;
    }

    function b64ToBlob(b64, contentType='application/octet-stream', sliceSize=512) {
      const byteChars = atob(b64);
      const byteArrays = [];
      for (let offset = 0; offset < byteChars.length; offset += sliceSize) {
        const slice = byteChars.slice(offset, offset + sliceSize);
        const byteNumbers = new Array(slice.length);
        for (let i = 0; i < slice.length; i++) byteNumbers[i] = slice.charCodeAt(i);
        byteArrays.push(new Uint8Array(byteNumbers));
      }
      return new Blob(byteArrays, { type: contentType });
    }

    async function generate() {
      hideStatus(); dlWrap.classList.add('hidden');
      const userPrompt = (promptEl.value || '').trim();
      if (!userPrompt) { showStatus('í”„ë¡¬í”„íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'warn'); return; }

      const planet = planetSel.value;
      const planetStyle = planetSel.options[planetSel.selectedIndex].dataset.style || '';
      const style = styleSel.value;
      const size = sizeSel.value;

      const payload = { planet, planet_style: planetStyle, user_prompt: userPrompt, style, size };

      showSpinner(true);
      try {
        // 
        // ğŸ”’ ë°±ì—”ë“œ ì—”ë“œí¬ì¸íŠ¸ ì˜ˆì‹œ: /api/generate
        // ì„œë²„ëŠ” OpenAI API í‚¤ë¥¼ ë³´ê´€í•˜ê³ , gpt-image-1 ë˜ëŠ” dall-e-3ë¡œ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ì—¬
        // { image_b64: "..." } ë˜ëŠ” { image_url: "..." } í˜•íƒœë¡œ ì‘ë‹µí•©ë‹ˆë‹¤.
        //
        const res = await fetch('/api/generate', {
          method: 'POST', headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });
        if (!res.ok) throw new Error('ì´ë¯¸ì§€ ìƒì„± ìš”ì²­ì´ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
        const data = await res.json();

        if (data.image_b64) {
          setPreviewFromB64(data.image_b64);
          showStatus('ìƒì„±ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');
        } else if (data.image_url) {
          setPreviewFromURL(data.image_url);
          showStatus('ìƒì„±ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');
        } else {
          throw new Error('ì„œë²„ ì‘ë‹µì— ì´ë¯¸ì§€ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
        }
      } catch (err) {
        console.error(err);
        showStatus('ì˜¤ë¥˜: ' + (err?.message || err), 'err');
      } finally {
        showSpinner(false);
      }
    }

    genBtn.addEventListener('click', generate);
  </script>

  <footer style="text-align:center; padding: 16px; color: #9db0ff66;">
    Â© 2025 í–‰ì„± ì¼ëŸ¬ìŠ¤íŠ¸ ìƒì„± ë°ëª¨ (í•™êµ ë‚´ë¶€ ì „ìš©)
  </footer>
</body>
</html>
