<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ğŸª ë‚˜ë§Œì˜ í–‰ì„± ê·¸ë¦¼ ë§Œë“¤ê¸° (ì§ì ‘ í‚¤ í¬í•¨)</title>
  <style>
    :root { --bg:#0b1020; --card:#121a33; --text:#eef3ff; --muted:#9fb0ff; --accent:#6ea8ff; --accent-2:#9ee5ff; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; background:radial-gradient(1200px 800px at 80% -20%, #1b2a6b22, transparent), var(--bg); color:var(--text)}
    header{text-align:center;padding:28px 16px 8px}
    header h1{margin:0;font-size:1.8rem}
    header p{margin:6px 0 0;color:var(--muted)}
    .container{max-width:980px;margin:0 auto;padding:20px 16px 48px}
    .card{background:linear-gradient(180deg,#121a33,#0f1530);border:1px solid #2a335e;border-radius:18px;padding:20px;box-shadow:0 8px 30px #00000044}
    .grid{display:grid;grid-template-columns:1.1fr 1fr;gap:18px}
    @media (max-width:900px){.grid{grid-template-columns:1fr}}
    label{display:block;margin:12px 0 6px;font-weight:600;color:var(--muted)}
    select,textarea,input[type=text]{width:100%;padding:12px 14px;border-radius:12px;border:1px solid #334072;background:#0c1330;color:var(--text);outline:none;transition:border .15s ease}
    select:focus,textarea:focus{border-color:var(--accent)}
    textarea{min-height:110px;resize:vertical}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media (max-width:600px){.row{grid-template-columns:1fr}}
    .btn{appearance:none;border:0;background:linear-gradient(180deg,var(--accent),#4c87ff);color:#051026;font-weight:800;letter-spacing:.3px;padding:12px 16px;border-radius:14px;cursor:pointer;box-shadow:0 6px 20px #2b54ff55;transition:transform .06s ease,filter .2s ease;width:100%}
    .btn:disabled{filter:grayscale(.7) brightness(.7);cursor:not-allowed}
    .btn:hover:not(:disabled){transform:translateY(-1px)}
    .preview{background:#0a1028;border:1px dashed #30407a;border-radius:16px;min-height:280px;display:grid;place-items:center;overflow:hidden}
    .preview img{width:100%;height:auto;display:block}
    .hint{font-size:.92rem;color:var(--muted)}
    .small{font-size:.86rem;color:#b6c4ff}
    .hidden{display:none}
    .status{margin-top:10px;padding:10px 12px;border-radius:12px;background:#0f1842;border:1px solid #2c3a7a}
    .download{margin-top:10px;display:flex;gap:10px;align-items:center}
    .download a{text-decoration:none;color:var(--accent-2);font-weight:700}
    footer{text-align:center;padding:16px;color:#9db0ff66}
  </style>
</head>
<body>
  <header>
    <h1>ğŸª ë‚˜ë§Œì˜ í–‰ì„± ê·¸ë¦¼ ë§Œë“¤ê¸°</h1>
    <p class="small">(ë‚´ë¶€ ì „ìš©) ì´ ë²„ì „ì€ <b>ë¸Œë¼ìš°ì €ì—ì„œ OpenAI APIë¥¼ ì§ì ‘ í˜¸ì¶œ</b>í•©ë‹ˆë‹¤. í‚¤ê°€ ë…¸ì¶œë  ìˆ˜ ìˆìœ¼ë‹ˆ ê³µê°œ ë°°í¬ ê¸ˆì§€!</p>
  </header>

  <div class="container">
    <div class="card grid">
      <section>
        <label for="apiKey">OpenAI API í‚¤</label>
        <input id="apiKey" type="password" placeholder="sk-ë¡œ ì‹œì‘í•˜ëŠ” í‚¤ë¥¼ ì…ë ¥í•˜ê±°ë‚˜, ì•„ë˜ KEY ìƒìˆ˜ì— í•˜ë“œì½”ë”©í•˜ì„¸ìš”" />

        <label for="planet">í–‰ì„± ì„ íƒ</label>
        <select id="planet">
          <option value="Mercury" data-style="ì‘ê³  íšŒìƒ‰ë¹›, ë§ì€ ìš´ì„ í¬ë ˆì´í„°, ëŒ€ê¸° í¬ë°•, íƒœì–‘ì— ë§¤ìš° ê°€ê¹Œì›€">ìˆ˜ì„± (Mercury)</option>
          <option value="Venus" data-style="ë‘êº¼ìš´ í™©ë°±ìƒ‰ êµ¬ë¦„, ë§¤ìš° ëœ¨ê±°ì›€, ë¶€ë“œëŸ¬ìš´ ê´‘ì±„, ì•½í•œ í‘œë©´ ë””í…Œì¼">ê¸ˆì„± (Venus)</option>
          <option value="Earth" data-style="í‘¸ë¥¸ ë°”ë‹¤, í•˜ì–€ êµ¬ë¦„, ì´ˆë¡ê³¼ ê°ˆìƒ‰ ëŒ€ë¥™, ìƒëª… ë„˜ì¹˜ëŠ” ëŠë‚Œ">ì§€êµ¬ (Earth)</option>
          <option value="Mars" data-style="ì ê°ˆìƒ‰ ì‚¬ë§‰, ê±°ëŒ€í•œ í™”ì‚°ê³¼ í˜‘ê³¡, ì—·ì€ ëŒ€ê¸°, ë¨¼ì§€í­í’ ê°€ëŠ¥">í™”ì„± (Mars)</option>
          <option value="Jupiter" data-style="ê°ˆìƒ‰ê³¼ í¬ë¦¼ìƒ‰ ì¤„ë¬´ëŠ¬, ê±°ëŒ€í•œ ë¶‰ì€ ì  í­í’, ê±°ëŒ€ ê°€ìŠ¤í–‰ì„±">ëª©ì„± (Jupiter)</option>
          <option value="Saturn" data-style="ì•„ë¦„ë‹¤ìš´ ê³ ë¦¬, í™©ê¸ˆë¹› ê°€ìŠ¤ì¸µ, ì„¬ì„¸í•œ ê³ ë¦¬ êµ¬ì¡° ë””í…Œì¼">í† ì„± (Saturn)</option>
          <option value="Uranus" data-style="ë°ì€ ì²­ë¡ìƒ‰, ì˜…ì€ êµ¬ë¦„, ì˜†ìœ¼ë¡œ ëˆ„ìš´ ìì „ì¶•, ì°¨ë¶„í•œ ëŠë‚Œ">ì²œì™•ì„± (Uranus)</option>
          <option value="Neptune" data-style="ì§„í•œ íŒŒë€ìƒ‰, ê°•í•œ ë°”ëŒ, ì–´ë‘ìš´ ì  í­í’ ê°€ëŠ¥, ì°¨ê°‘ê³  ê¹Šì€ ë°”ë‹¤ ëŠë‚Œ">í•´ì™•ì„± (Neptune)</option>
        </select>

        <label for="prompt">í”„ë¡¬í”„íŠ¸</label>
        <textarea id="prompt" placeholder="ì˜ˆ) ì•„ì´ë“¤ì´ ë°”ë¼ë³´ëŠ” ë§Œí™”í’, ë³„ë¹›ì´ ë°˜ì§ì´ëŠ” ë°°ê²½, ë”°ëœ»í•œ ìƒ‰ê°"></textarea>

        <div class="row">
          <div>
            <label for="style">ìŠ¤íƒ€ì¼ (ì„ íƒ)</label>
            <select id="style">
              <option value="">ìë™</option>
              <option>ìˆ˜ì±„í™”</option>
              <option>ë§Œí™”í’</option>
              <option>í”½ì…€ì•„íŠ¸</option>
              <option>ìœ í™”</option>
              <option>ë¦¬ì–¼ë¦¬ì¦˜</option>
              <option>í”Œë« ì¼ëŸ¬ìŠ¤íŠ¸</option>
            </select>
          </div>
          <div>
            <label for="size">ì´ë¯¸ì§€ í¬ê¸°</label>
            <select id="size">
              <option>1024x1024</option>
              <option>1024x1792</option>
              <option>1792x1024</option>
            </select>
          </div>
        </div>

        <div style="margin-top:16px; display:flex; gap:10px; align-items:center;">
          <button id="generate" class="btn">ê·¸ë¦¼ ë§Œë“¤ê¸°</button>
          <span id="spinner" class="small hidden">ìƒì„± ì¤‘ì…ë‹ˆë‹¤â€¦</span>
        </div>

        <div id="status" class="status hidden"></div>
      </section>

      <section>
        <div class="preview" id="preview"><div class="hint">ì—¬ê¸°ì— ì´ë¯¸ì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤</div></div>
        <div class="download hidden" id="downloadWrap">
          <a id="downloadLink" download>ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ</a>
          <span id="meta" class="small"></span>
        </div>
      </section>
    </div>
  </div>

  <script>
    // =========================
    // ğŸ”‘ 1) ì—¬ê¸° KEY ìƒìˆ˜ì— ì§ì ‘ ë„£ê±°ë‚˜, í˜ì´ì§€ ìƒë‹¨ ì…ë ¥ë€(id=apiKey)ì— ì…ë ¥í•˜ì„¸ìš”.
    // =========================
    const KEY = ""; // ì˜ˆ: "sk-XXXX..." (ë¹„ì›Œë‘ë©´ ì…ë ¥ë€ì˜ ê°’ ì‚¬ìš©)

    // ë¸Œë¼ìš°ì €ì—ì„œ OpenAI API í˜¸ì¶œ: CORS ì •ì±…ì´ ë°”ë€Œë©´ ë™ì‘í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    // ë¬¸ì œê°€ ìƒê¸°ë©´ ì„œë²„ í”„ë¡ì‹œ(/api/generate) ë°©ì‹ì„ ì‚¬ìš©í•˜ì„¸ìš”.

    const el = (id) => document.getElementById(id);
    const planetSel = el('planet');
    const promptEl  = el('prompt');
    const styleSel  = el('style');
    const sizeSel   = el('size');
    const genBtn    = el('generate');
    const spinner   = el('spinner');
    const statusBox = el('status');
    const preview   = el('preview');
    const dlWrap    = el('downloadWrap');
    const dlLink    = el('downloadLink');
    const meta      = el('meta');
    const keyInput  = el('apiKey');

    function showStatus(msg, kind='info'){
      statusBox.textContent = msg; statusBox.classList.remove('hidden');
      statusBox.style.background = kind==='err' ? '#3d0d10' : '#0f1842';
      statusBox.style.border = kind==='err' ? '1px solid #c23d45' : '1px solid #2c3a7a';
    }
    function hideStatus(){ statusBox.classList.add('hidden'); }
    function showSpinner(on){ spinner.classList.toggle('hidden', !on); genBtn.disabled = on; }

    function makeFileName(ext){
      const p = (planetSel?.value || 'planet').replace(/\s+/g,'_');
      const ts = new Date().toISOString().replaceAll(':','').replaceAll('-','').slice(0,15);
      return `${p}_${ts}.${ext}`;
    }
    function b64ToBlob(b64, contentType='image/png'){
      const byteChars = atob(b64); const byteArrays=[]; const sliceSize=512;
      for(let offset=0; offset<byteChars.length; offset+=sliceSize){
        const slice = byteChars.slice(offset, offset+sliceSize);
        const nums = new Array(slice.length);
        for(let i=0;i<slice.length;i++) nums[i] = slice.charCodeAt(i);
        byteArrays.push(new Uint8Array(nums));
      }
      return new Blob(byteArrays,{type:contentType});
    }
    function setPreviewFromB64(b64){
      const img = new Image(); img.src = `data:image/png;base64,${b64}`; img.alt='ìƒì„±ëœ ì´ë¯¸ì§€';
      preview.innerHTML=''; preview.appendChild(img);
      const url = URL.createObjectURL(b64ToBlob(b64));
      dlLink.href = url; dlLink.download = makeFileName('png');
      dlWrap.classList.remove('hidden');
      meta.textContent = new Date().toLocaleString();
    }

    async function callOpenAIImage(prompt, size){
      const apiKey = KEY || keyInput.value.trim();
      if(!apiKey){ throw new Error('API í‚¤ê°€ ì—†ìŠµë‹ˆë‹¤. KEY ìƒìˆ˜ì— ë„£ê±°ë‚˜ ì…ë ¥ë€ì— ì…ë ¥í•˜ì„¸ìš”.'); }

      const body = { model: 'gpt-image-1', prompt, size, n: 1, response_format: 'b64_json' };

      const res = await fetch('https://api.openai.com/v1/images/generations',{
        method:'POST',
        headers:{ 'Content-Type':'application/json', 'Authorization':`Bearer ${apiKey}` },
        body: JSON.stringify(body)
      });
      if(!res.ok){
        let detail = await res.text();
        throw new Error(`OpenAI ìš”ì²­ ì‹¤íŒ¨ (${res.status}) ${detail}`);
      }
      const data = await res.json();
      const d0 = data?.data?.[0];
      if(d0?.b64_json){ return { b64: d0.b64_json }; }
      if(d0?.url){ return { url: d0.url }; }
      throw new Error('ì´ë¯¸ì§€ ë°ì´í„°ê°€ ì‘ë‹µì— ì—†ìŠµë‹ˆë‹¤.');
    }

    async function generate(){
      hideStatus(); dlWrap.classList.add('hidden');
      const userPrompt = (promptEl.value||'').trim();
      if(!userPrompt){ showStatus('í”„ë¡¬í”„íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.','err'); return; }

      const planet = planetSel.value;
      const planetStyle = planetSel.options[planetSel.selectedIndex].dataset.style || '';
      const style = styleSel.value;
      const size = sizeSel.value;

      const styleTag = style ? `, ìŠ¤íƒ€ì¼: ${style}` : '';
      const sys = `ì¹œê·¼í•œ êµìœ¡ìš© ìš°ì£¼ ì¼ëŸ¬ìŠ¤íŠ¸. ë°°ê²½ì€ ìš°ì£¼, ì¤‘ì‹¬ ì£¼ì œëŠ” íƒœì–‘ê³„ í–‰ì„± '${planet}'. ê³¼ë„í•œ ì™œê³¡ ì—†ì´ íŠ¹ì§•ì„ ë³´ì—¬ì£¼ì„¸ìš”.`;
      const full = `${sys}\ní–‰ì„± íŠ¹ì§•: ${planetStyle}\nì‚¬ìš©ì ìš”ì²­: ${userPrompt}${styleTag}`;

      showSpinner(true);
      try{
        const result = await callOpenAIImage(full, size);
        if(result.b64){ setPreviewFromB64(result.b64); showStatus('ìƒì„±ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.'); }
        else if(result.url){ preview.innerHTML = `<img src="${result.url}" alt="ìƒì„±ëœ ì´ë¯¸ì§€" referrerpolicy="no-referrer"/>`; showStatus('ìƒì„±ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.'); }
      }catch(err){ console.error(err); showStatus('ì˜¤ë¥˜: '+(err?.message||err),'err'); }
      finally{ showSpinner(false); }
    }

    genBtn.addEventListener('click', generate);
    promptEl.addEventListener('keydown', e=>{ if((e.ctrlKey||e.metaKey)&&e.key==='Enter') generate(); });
  </script>

  <footer>Â© 2025 í–‰ì„± ì¼ëŸ¬ìŠ¤íŠ¸ ìƒì„± ë°ëª¨ â€” ë‚´ë¶€ ì „ìš©</footer>
</body>
</html>
